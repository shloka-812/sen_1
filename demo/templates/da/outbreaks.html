{% extends "da/base.html" %}
{% load staticfiles %}
{% block body_block %}
<!doctype html>
<html lang="en">
  <head>
    <link rel="stylesheet" href="https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.3.0/css/ol.css" type="text/css">
    <style>
      .map {
        height: 100%;
        width: 100%;
      }
    </style>
    <script src="https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.3.0/build/ol.js"></script>
    <title>OpenLayers example</title>
  </head>
  <body>
    <h2>Detected Outbreaks</h2>
    <form  method="post">
    	{% csrf_token %}
    	{{ form }}
    	<input type="submit" value="Submit">
	</form>
	{% if request.POST %}
	<p>Got values {{fromDate}} and {{toDate}} and {{diseaseName}} <br> </p>
	{% endif %}

    <div id="map" class="map"></div>
    <script type="text/javascript">
      //query: tuples that have from date ,to date and disease as specified by user, 
      var map = new ol.Map({
        target: 'map',
        layers: [
          new ol.layer.Tile({
            source: new ol.source.OSM()
          })
        ],
        view: new ol.View({
          center: ol.proj.fromLonLat([72.6,23.2]),
          zoom: 2.1
        })
      });
      var marker = new Array();
      var deathlist = {{dq}};
      var afflist = {{aq}};
      var dnum = {{dn}}
      var anum = {{an}}
      
      i=0;
      for (var key in deathlist){
      	 var value = deathlist[key];
         marker[i] = new ol.Feature({
	  	 geometry: new ol.geom.Point(
	    	ol.proj.fromLonLat(value)
	  	),
		});
         i=i+1;
        }
      j=0;
       
      for (var key in afflist){
      	 var value = afflist[key];
         marker[i] = new ol.Feature({
	  	 geometry: new ol.geom.Point(
	    	ol.proj.fromLonLat(value)
	  	),
		});
         i=i+1;
         j=j+1;
      }
      /*
    	marker[0] = new ol.Feature({
	  	 geometry: new ol.geom.Point(
	    	ol.proj.fromLonLat(deathlist["0"])
	  	),
		});
		marker[1] = new ol.Feature({
	  	 geometry: new ol.geom.Point(
	    	ol.proj.fromLonLat(afflist["0"])
	  	),
		});
		marker[2] = new ol.Feature({
	  	 geometry: new ol.geom.Point(
	    	ol.proj.fromLonLat(afflist["1"])
	  	),
		});*/
      
	var vectorSource = new ol.source.Vector({
	  features: marker
	});
	var markerVectorLayer = new ol.layer.Vector({
	  source: vectorSource,
	});
	map.addLayer(markerVectorLayer);
    </script>
  </body>
</html>
{% endblock %}